```typescript
// 大学课程表业务模型
const universityBusinessModel = {
  // 基础数据
  totalCourses: 1600,           // 一学期课程数
  totalClasses: 50000,          // 总课节数（约5万节）
  studentsPerClass: 50,         // 每节课学生数
  dailyClasses: 8,              // 每天8节课
  semesterDays: 120,            // 一学期约120天
  
  // 时间分布分析
  classSchedule: {
    morning: {
      slots: [
        { time: '08:00-08:45', classes: 200 },  // 第1节课
        { time: '08:55-09:40', classes: 200 },  // 第2节课
        { time: '10:00-10:45', classes: 180 },  // 第3节课
        { time: '10:55-11:40', classes: 180 }   // 第4节课
      ]
    },
    afternoon: {
      slots: [
        { time: '14:00-14:45', classes: 150 },  // 第5节课
        { time: '14:55-15:40', classes: 150 },  // 第6节课
        { time: '16:00-16:45', classes: 120 },  // 第7节课
        { time: '16:55-17:40', classes: 120 }   // 第8节课
      ]
    }
  },
  
  // 签到高峰分析
  checkInPeaks: {
    peakMorning: {
      time: '08:00-08:05',        // 早晨第一节课
      concurrentClasses: 200,     // 同时上课的课程数
      studentsPerClass: 50,       // 每课学生数
      totalStudents: 10000,       // 同时签到学生数
      checkInWindow: 300,         // 5分钟签到窗口（秒）
      peakQPS: 33                 // 10000学生/300秒 ≈ 33 QPS
    },
    peakAfternoon: {
      time: '14:00-14:05',
      concurrentClasses: 150,
      totalStudents: 7500,
      peakQPS: 25                 // 7500学生/300秒 = 25 QPS
    }
  },
  
  // 数据量估算
  dataVolume: {
    dailyCheckIns: 20000,         // 日签到次数（8节课×平均250课×50人）
    semesterCheckIns: 2400000,    // 学期签到次数（120天×20000）
    yearCheckIns: 4800000,        // 年签到次数（两学期）
    
    // 存储计算
    checkInRecordSize: 512,       // 每条签到记录512字节（简化版）
    dailyStorage: 10,             // 日存储增长10MB
    semesterStorage: 1.2,         // 学期存储1.2GB
    yearStorage: 2.4              // 年存储2.4GB
  }
};

// 真实并发计算
const realConcurrencyAnalysis = {
  // 最高峰场景：早晨第一节课
  worstCase: {
    scenario: "周一早晨8点第一节课",
    concurrentClasses: 200,
    studentsPerClass: 50,
    totalStudents: 10000,
    checkInWindow: 300,           // 5分钟
    
    // 考虑学生行为分布（不是均匀分布）
    checkInDistribution: {
      first2Minutes: 0.7,         // 70%学生在前2分钟签到
      next2Minutes: 0.25,         // 25%学生在第3-4分钟签到
      lastMinute: 0.05            // 5%学生在最后1分钟签到
    },
    
    // 实际峰值QPS计算
    peakQPS: Math.ceil(10000 * 0.7 / 120), // 7000人/120秒 ≈ 58 QPS
    averageQPS: Math.ceil(10000 / 300),     // 10000人/300秒 ≈ 33 QPS
    
    // 考虑重试和失败重新签到
    retryFactor: 1.2,             // 20%重试率
    finalPeakQPS: Math.ceil(58 * 1.2) // 约70 QPS
  }

  // 数据库操作分析
    dbOperations: {
      writeOps: 70,        // 签到记录写入
      readOps: 140,        // 课程信息查询（2倍读取）
      cacheOps: 280        // 缓存查询（4倍缓存）
    }
};
```


# 基于华为云的高可用部署方案
  
  服务器1 - 应用+Nginx主+Redis主:
    硬件配置:
      CPU: 8核心
      内存: 16GB
      存储: 500GB
      网络: 千兆网卡
    
    组件部署:
      - Nginx主节点: 1C2G
      - 接口服务1-1: 1C2G
      - 接口服务1-1: 1C2G
      - 手机页面2-1: 1C4G
      - 手机页面2-2: 1C4G
      - 管理后台页面3-1: 2C2G
      - 管理后台接口3-2: 2C2G
      - Redis主节点: 2C4G
      - 监控代理: 0.5C1G
    
    
  服务器2 - 应用+Nginx备+Redis从:
    硬件配置:
      CPU: 2核心
      内存: 4GB
      存储: 500GB
      网络: 千兆网卡
    组件部署:
      - Nginx备节点: 1C2G
      - 接口服务1-1: 1C2G
      - 手机页面2-1: 1C2G
      - 管理后台页面3-1(待定): 2C4G
      - 管理后台接口3-2（待定）: 2C4G
      - 同步服务4-1: 2C4G
      - 同步专用MySQL: 1C2G (轻量级)
      - Redis从节点: 2C4G
      - 监控代理: 0.5C1G
      - 系统预留: 4.5C8G
    
    高可用特性:
      - 与服务器1形成完全冗余
      - 任意一台故障不影响服务
      - 自动故障转移

    华为云RDS MySQL服务:
    主实例配置:
        规格: rds.mysql.c3.large.2 (2C4G)
        存储: 500GB 超高IO云硬盘
        版本: MySQL 8.0
        可用区: 跨可用区部署
        备份: 自动备份，保留7天
  
    只读实例配置:
        规格: rds.mysql.c3.large.2 (2C4G)
        存储: 500GB 超高IO云硬盘
        用途: 读写分离，提升查询性能
  
    华为云附加服务:
        - ELB弹性负载均衡
        - DNS智能解析

// 单节点QBS分析
```typescript
// 应用性能分析
  applicationPerformance: {
    // Node.js单核性能
    nodeJSPerformance: {
      eventLoopCapacity: 1000, // 事件循环处理能力
      concurrentConnections: 200, // 最大并发连接
      memoryPerConnection: 5, // 每连接5MB内存
      maxConnections: 200 // 内存限制的最大连接数
    },
    
    // 签到请求处理分析
    checkInRequestProcessing: {
      cpuTimePerRequest: 15, // CPU处理时间15ms
      memoryPerRequest: 2, // 每请求2MB内存
      databaseWaitTime: 30, // 数据库等待时间30ms（含锁竞争）
      totalResponseTime: 50, // 总响应时间50ms
      
      // QPS计算
      theoreticalQPS: 1000 / 50, // 20 QPS (串行)
      concurrentQPS: 200 / (50/1000), // 4000 QPS (理论并发)
      
      // 实际限制因素
      limitingFactors: {
        cpuBottleneck: 1000 / 15, // CPU限制: 67 QPS
        memoryBottleneck: 1024 / 2, // 内存限制: 512 QPS
        databaseBottleneck: 50 / (30/1000), // 数据库限制: 1667 QPS
        networkBottleneck: 1000 // 网络限制: 1000 QPS
      },
      
      actualBottleneck: "CPU处理能力", // 最小值决定瓶颈
      actualQPS: 67 // 实际QPS能力
    }
  },
  
  // 数据库锁竞争影响
  databaseLockImpact: {
    // 不同并发级别的锁竞争影响
    lockContentionImpact: {
      lowLoad: {
        qpsRange: "0-20",
        lockWaitTime: 2, // 额外等待2ms
        performanceImpact: "5%",
        actualQPS: 64 // 67 * 0.95
      },
      
      mediumLoad: {
        qpsRange: "20-40", 
        lockWaitTime: 8, // 额外等待8ms
        performanceImpact: "20%",
        actualQPS: 54 // 67 * 0.8
      },
      
      highLoad: {
        qpsRange: "40-60",
        lockWaitTime: 20, // 额外等待20ms
        performanceImpact: "35%", 
        actualQPS: 44 // 67 * 0.65
      },
      
      extremeLoad: {
        qpsRange: "> 60",
        lockWaitTime: 50, // 额外等待50ms
        performanceImpact: "50%",
        actualQPS: 34 // 67 * 0.5
      }
    },
     // 最终评估理论
  finalAssessment: {
    conservativeEstimate: {
      qps: 50, // 保守估计50 QPS
    },
    
    optimisticEstimate: {
      qps: 80, // 乐观估计80 QPS
    },
    
    recommendedValue: 
      qps: 60, // 预估平均值 QPS
  }
}
```

部署3个节点
单节点能力：60 QPS（1C2G配置）
系统设计：3个节点，总计180 QPS
安全余量：257%