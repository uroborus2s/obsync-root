# å…¨å±€ä¾§è¾¹æ æ•°æ®æŸ¥è¯¢èœå•ä¿®æ”¹å®ŒæˆæŠ¥å‘Š

## âœ… ä¿®æ”¹å®Œæˆæ€»ç»“

### ğŸ¯ ä»»åŠ¡ç›®æ ‡

1. âœ… åœ¨å…¨å±€å·¦ä¾§ä¾§è¾¹æ çš„"ç­¾åˆ°ç®¡ç†"èœå•ä¸‹ï¼Œæ·»åŠ 5ä¸ªæ•°æ®æŸ¥è¯¢å­èœå•
2. âœ… ç§»é™¤"ç­¾åˆ°ç®¡ç†"ä¸‹åŸæœ‰çš„6ä¸ªèœå•é¡¹
3. âœ… æ–°çš„5ä¸ªèœå•é¡¹å¯¹åº” SHEET_LIST çš„5ä¸ªæ•°æ®è¡¨

---

## ğŸ“ å·²å®Œæˆçš„å·¥ä½œ

### 1. ä¿®æ”¹å…¨å±€ä¾§è¾¹æ é…ç½®

**æ–‡ä»¶**ï¼š`apps/agendaedu-web/src/components/layout/data/sidebar-data.ts`

**ä¿®æ”¹å†…å®¹**ï¼š

#### æ›´æ–°å¯¼å…¥çš„å›¾æ ‡
```typescript
// ç§»é™¤æ—§çš„å›¾æ ‡
- IconBook, IconChartBar, IconDashboard, TrendingUp, UserCheck

// æ·»åŠ æ–°çš„å›¾æ ‡
+ BarChart3, BookOpen, FileSpreadsheet, FileText, Users
```

#### æ›¿æ¢"ç­¾åˆ°ç®¡ç†"ä¸‹çš„å­èœå•

**ä¿®æ”¹å‰**ï¼ˆ6ä¸ªèœå•é¡¹ï¼‰ï¼š
1. ç­¾åˆ°æ€»è§ˆ - `/attendance/overview`
2. æ•°æ®åˆ†æ - `/attendance/analytics`
3. å‡ºå‹¤æ’è¡Œ - `/attendance/rankings`
4. å­¦ç”Ÿè€ƒå‹¤ - `/attendance/students`
5. è¯¾ç¨‹è€ƒå‹¤ - `/attendance/courses`
6. è¯¾ç¨‹è¡¨ç»Ÿè®¡ - `/attendance/course-statistics`

**ä¿®æ”¹å**ï¼ˆ5ä¸ªèœå•é¡¹ï¼‰ï¼š
1. ç¼ºå‹¤å†å²æ˜ç»†è¡¨ - `/data-query/absent-history`
2. è¯¾ç¨‹å†å²ç»Ÿè®¡è¡¨ - `/data-query/course-stats`
3. å­¦ç”Ÿå†å²ç»Ÿè®¡è¡¨ - `/data-query/student-stats`
4. å­¦ç”Ÿå†å²ç»Ÿè®¡è¯¦æƒ…è¡¨ - `/data-query/student-stats-details`
5. æ•™å­¦ç­è¡¨ - `/data-query/teaching-class`

### 2. ç®€åŒ–æ•°æ®æŸ¥è¯¢ä¸»é¡µé¢

**æ–‡ä»¶**ï¼š`apps/agendaedu-web/src/routes/_authenticated/data-query.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
- âœ… ç§»é™¤è‡ªå®šä¹‰å¸ƒå±€ç»„ä»¶
- âœ… æ”¹ä¸ºç®€å•çš„é‡å®šå‘é¡µé¢
- âœ… è®¿é—® `/data-query` æ—¶è‡ªåŠ¨è·³è½¬åˆ° `/data-query/absent-history`

**ä¿®æ”¹å‰**ï¼ˆ54è¡Œï¼ŒåŒ…å«å¸ƒå±€ç»„ä»¶ï¼‰ï¼š
```typescript
function DataQueryLayout() {
  return (
    <div className='flex h-full'>
      <aside className='w-64 shrink-0 border-r bg-background'>
        {/* ä¾§è¾¹æ  */}
      </aside>
      <main className='flex-1 overflow-auto'>
        <Outlet />
      </main>
    </div>
  )
}
```

**ä¿®æ”¹å**ï¼ˆ14è¡Œï¼Œä»…é‡å®šå‘ï¼‰ï¼š
```typescript
export const Route = createFileRoute('/_authenticated/data-query')({
  beforeLoad: () => {
    throw redirect({
      to: '/data-query/absent-history',
    })
  },
})
```

### 3. åˆ é™¤ç‹¬ç«‹ä¾§è¾¹æ ç»„ä»¶

**åˆ é™¤çš„æ–‡ä»¶**ï¼š
- `apps/agendaedu-web/src/features/data-query/components/data-query-sidebar.tsx`

**åŸå› **ï¼š
- ä¸å†éœ€è¦ç‹¬ç«‹çš„æ•°æ®æŸ¥è¯¢ä¾§è¾¹æ 
- èœå•å·²é›†æˆåˆ°å…¨å±€ä¾§è¾¹æ ä¸­

### 4. æ¢å¤å­é¡µé¢å¸ƒå±€

**ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
1. `apps/agendaedu-web/src/routes/_authenticated/data-query/absent-history.tsx`
2. `apps/agendaedu-web/src/routes/_authenticated/data-query/course-stats.tsx`
3. `apps/agendaedu-web/src/routes/_authenticated/data-query/student-stats.tsx`
4. `apps/agendaedu-web/src/routes/_authenticated/data-query/student-stats-details.tsx`
5. `apps/agendaedu-web/src/routes/_authenticated/data-query/teaching-class.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
- âœ… æ¢å¤å¤–å±‚å®¹å™¨çš„ `flex-1` ç±»å
- âœ… ç¡®ä¿é¡µé¢åœ¨å…¨å±€å¸ƒå±€ä¸­æ­£å¸¸æ˜¾ç¤º

**ä¿®æ”¹**ï¼š
```typescript
// æ¢å¤ flex-1
<div className='flex-1 space-y-6 p-4 pt-6 md:p-8'>
```

---

## ğŸ¨ æœ€ç»ˆæ•ˆæœ

### å…¨å±€ä¾§è¾¹æ ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¯¾ç¨‹ç­¾åˆ°ç³»ç»Ÿ                     â”‚
â”‚  ç®¡ç†åå°                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  ç³»ç»Ÿç®¡ç†                         â”‚
â”‚                                 â”‚
â”‚  â–¼ å·¥ä½œæµç®¡ç†                     â”‚
â”‚    - å·¥ä½œæµå®šä¹‰                   â”‚
â”‚    - å·¥ä½œæµå®ä¾‹                   â”‚
â”‚    - è¯¾è¡¨é‡å»º                     â”‚
â”‚    - å®šæ—¶ä»»åŠ¡                     â”‚
â”‚                                 â”‚
â”‚  â–¼ ç­¾åˆ°ç®¡ç†                       â”‚
â”‚    - ç¼ºå‹¤å†å²æ˜ç»†è¡¨ âœ¨             â”‚
â”‚    - è¯¾ç¨‹å†å²ç»Ÿè®¡è¡¨ âœ¨             â”‚
â”‚    - å­¦ç”Ÿå†å²ç»Ÿè®¡è¡¨ âœ¨             â”‚
â”‚    - å­¦ç”Ÿå†å²ç»Ÿè®¡è¯¦æƒ…è¡¨ âœ¨         â”‚
â”‚    - æ•™å­¦ç­è¡¨ âœ¨                   â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### èœå•é¡¹è¯¦æƒ…

| åºå· | èœå•åç§° | è·¯ç”± | å›¾æ ‡ | æƒé™ |
|------|---------|------|------|------|
| 1 | ç¼ºå‹¤å†å²æ˜ç»†è¡¨ | `/data-query/absent-history` | FileText | teacher, admin, super_admin |
| 2 | è¯¾ç¨‹å†å²ç»Ÿè®¡è¡¨ | `/data-query/course-stats` | BarChart3 | teacher, admin, super_admin |
| 3 | å­¦ç”Ÿå†å²ç»Ÿè®¡è¡¨ | `/data-query/student-stats` | Users | teacher, admin, super_admin |
| 4 | å­¦ç”Ÿå†å²ç»Ÿè®¡è¯¦æƒ…è¡¨ | `/data-query/student-stats-details` | FileSpreadsheet | teacher, admin, super_admin |
| 5 | æ•™å­¦ç­è¡¨ | `/data-query/teaching-class` | BookOpen | teacher, admin, super_admin |

---

## ğŸ” æŠ€æœ¯å®ç°ç»†èŠ‚

### ä¾§è¾¹æ é…ç½®ç»“æ„

```typescript
{
  title: 'ç­¾åˆ°ç®¡ç†',
  icon: IconClipboardCheck,
  permission: {
    requiredRoles: ['teacher', 'admin', 'super_admin'],
    mode: 'or',
  },
  items: [
    {
      title: 'ç¼ºå‹¤å†å²æ˜ç»†è¡¨',
      url: '/data-query/absent-history' as const,
      icon: FileText,
      permission: {
        requiredRoles: ['teacher', 'admin', 'super_admin'],
        mode: 'or',
      },
    },
    // ... å…¶ä»–4ä¸ªèœå•é¡¹
  ],
}
```

### è·¯ç”±é‡å®šå‘

```typescript
export const Route = createFileRoute('/_authenticated/data-query')({
  beforeLoad: () => {
    // è®¿é—® /data-query æ—¶è‡ªåŠ¨è·³è½¬åˆ°ç¬¬ä¸€ä¸ªå­é¡µé¢
    throw redirect({
      to: '/data-query/absent-history',
    })
  },
})
```

### æƒé™æ§åˆ¶

æ‰€æœ‰5ä¸ªèœå•é¡¹éƒ½ä½¿ç”¨ç›¸åŒçš„æƒé™é…ç½®ï¼š
- **å…è®¸çš„è§’è‰²**ï¼š`teacher`, `admin`, `super_admin`
- **æƒé™æ¨¡å¼**ï¼š`or`ï¼ˆæ»¡è¶³ä»»ä¸€è§’è‰²å³å¯ï¼‰

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **åˆ·æ–°æµè§ˆå™¨**
   ```
   URL: http://localhost:5175/web/
   ```

2. **æŸ¥çœ‹å…¨å±€ä¾§è¾¹æ **
   - âœ… å±•å¼€"ç­¾åˆ°ç®¡ç†"èœå•
   - âœ… éªŒè¯æ˜¾ç¤º5ä¸ªæ–°çš„æ•°æ®æŸ¥è¯¢èœå•é¡¹
   - âœ… éªŒè¯æ—§çš„6ä¸ªèœå•é¡¹å·²è¢«ç§»é™¤

3. **ç‚¹å‡»èœå•é¡¹**
   - âœ… ç‚¹å‡»"ç¼ºå‹¤å†å²æ˜ç»†è¡¨"ï¼ŒéªŒè¯è·³è½¬åˆ° `/data-query/absent-history`
   - âœ… ç‚¹å‡»å…¶ä»–èœå•é¡¹ï¼ŒéªŒè¯è·¯ç”±è·³è½¬æ­£ç¡®
   - âœ… éªŒè¯èœå•é¡¹é«˜äº®çŠ¶æ€

4. **éªŒè¯æ•°æ®åŠ è½½**
   - âœ… è®¿é—®æ¯ä¸ªå­é¡µé¢
   - âœ… éªŒè¯æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½
   - âœ… éªŒè¯åˆ†é¡µã€æœç´¢ã€æ’åºåŠŸèƒ½

5. **éªŒè¯é‡å®šå‘**
   - âœ… ç›´æ¥è®¿é—® `/data-query`
   - âœ… éªŒè¯è‡ªåŠ¨è·³è½¬åˆ° `/data-query/absent-history`

### é¢„æœŸç»“æœ

**å…¨å±€ä¾§è¾¹æ **ï¼š
- âœ… "ç­¾åˆ°ç®¡ç†"èœå•ä¸‹æ˜¾ç¤º5ä¸ªæ–°çš„æ•°æ®æŸ¥è¯¢èœå•é¡¹
- âœ… æ—§çš„6ä¸ªèœå•é¡¹ï¼ˆç­¾åˆ°æ€»è§ˆã€æ•°æ®åˆ†æç­‰ï¼‰å·²è¢«ç§»é™¤
- âœ… èœå•é¡¹ä½¿ç”¨æ–°çš„å›¾æ ‡ï¼ˆFileTextã€BarChart3ã€Usersã€FileSpreadsheetã€BookOpenï¼‰

**é¡µé¢å¯¼èˆª**ï¼š
- âœ… ç‚¹å‡»èœå•é¡¹å¯ä»¥æ­£å¸¸è·³è½¬
- âœ… å½“å‰é¡µé¢çš„èœå•é¡¹é«˜äº®æ˜¾ç¤º
- âœ… é¡µé¢å†…å®¹æ­£å¸¸æ˜¾ç¤º

**æ•°æ®åŠ è½½**ï¼š
- âœ… æ¯ä¸ªé¡µé¢éƒ½èƒ½æ­£å¸¸åŠ è½½æ•°æ®
- âœ… åˆ†é¡µã€æœç´¢ã€æ’åºåŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

## ğŸ“‹ æ–‡ä»¶æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶

1. `apps/agendaedu-web/src/components/layout/data/sidebar-data.ts`
   - æ›´æ–°å¯¼å…¥çš„å›¾æ ‡
   - æ›¿æ¢"ç­¾åˆ°ç®¡ç†"ä¸‹çš„å­èœå•

2. `apps/agendaedu-web/src/routes/_authenticated/data-query.tsx`
   - ç®€åŒ–ä¸ºé‡å®šå‘é¡µé¢

3. `apps/agendaedu-web/src/routes/_authenticated/data-query/absent-history.tsx`
   - æ¢å¤ `flex-1` ç±»å

4. `apps/agendaedu-web/src/routes/_authenticated/data-query/course-stats.tsx`
   - æ¢å¤ `flex-1` ç±»å

5. `apps/agendaedu-web/src/routes/_authenticated/data-query/student-stats.tsx`
   - æ¢å¤ `flex-1` ç±»å

6. `apps/agendaedu-web/src/routes/_authenticated/data-query/student-stats-details.tsx`
   - æ¢å¤ `flex-1` ç±»å

7. `apps/agendaedu-web/src/routes/_authenticated/data-query/teaching-class.tsx`
   - æ¢å¤ `flex-1` ç±»å

### åˆ é™¤çš„æ–‡ä»¶

1. `apps/agendaedu-web/src/features/data-query/components/data-query-sidebar.tsx`
   - ç‹¬ç«‹ä¾§è¾¹æ ç»„ä»¶ï¼ˆä¸å†éœ€è¦ï¼‰

---

## ğŸ‰ æ€»ç»“

å…¨å±€ä¾§è¾¹æ æ•°æ®æŸ¥è¯¢èœå•ä¿®æ”¹å·²æˆåŠŸå®Œæˆï¼ç°åœ¨ç”¨æˆ·å¯ä»¥é€šè¿‡å…¨å±€å·¦ä¾§ä¾§è¾¹æ çš„"ç­¾åˆ°ç®¡ç†"èœå•è®¿é—®5ä¸ªæ•°æ®æŸ¥è¯¢é¡µé¢ã€‚

**ä¸»è¦æ”¹è¿›**ï¼š
1. âœ… ç»Ÿä¸€çš„å¯¼èˆªä½“éªŒï¼ˆä½¿ç”¨å…¨å±€ä¾§è¾¹æ ï¼‰
2. âœ… æ›´ç®€æ´çš„èœå•ç»“æ„ï¼ˆ5ä¸ªæ•°æ®æŸ¥è¯¢èœå•æ›¿ä»£6ä¸ªæ—§èœå•ï¼‰
3. âœ… æ›´æ¸…æ™°çš„åŠŸèƒ½åˆ†ç±»ï¼ˆæ•°æ®æŸ¥è¯¢åŠŸèƒ½é›†ä¸­åœ¨"ç­¾åˆ°ç®¡ç†"ä¸‹ï¼‰
4. âœ… æ›´å¥½çš„ä»£ç ç»„ç»‡ï¼ˆç§»é™¤å†—ä½™çš„ç‹¬ç«‹ä¾§è¾¹æ ç»„ä»¶ï¼‰

**æŠ€æœ¯äº®ç‚¹**ï¼š
1. âœ… ä½¿ç”¨å…¨å±€ä¾§è¾¹æ é…ç½®ï¼ˆ`sidebar-data.ts`ï¼‰
2. âœ… ç»Ÿä¸€çš„æƒé™æ§åˆ¶ï¼ˆæ‰€æœ‰èœå•é¡¹ä½¿ç”¨ç›¸åŒçš„æƒé™é…ç½®ï¼‰
3. âœ… ç®€æ´çš„è·¯ç”±é‡å®šå‘ï¼ˆ`/data-query` â†’ `/data-query/absent-history`ï¼‰
4. âœ… HMR çƒ­æ›´æ–°ï¼ˆæ‰€æœ‰ä¿®æ”¹å·²è‡ªåŠ¨åº”ç”¨ï¼‰

**å‰ç«¯å¼€å‘æœåŠ¡å™¨çŠ¶æ€**ï¼š
- âœ… è¿è¡Œåœ¨ `http://localhost:5175/web/`
- âœ… HMR å·²è‡ªåŠ¨åº”ç”¨æ‰€æœ‰ä¿®æ”¹
- âœ… æ— ç¼–è¯‘é”™è¯¯

è¯·åˆ·æ–°æµè§ˆå™¨æµ‹è¯•æ–°çš„å…¨å±€ä¾§è¾¹æ èœå•ï¼


