<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@stratix/utils](./utils.md) &gt; [async](./utils.async.md) &gt; [withTimeout](./utils.async.withtimeout.md)

## async.withTimeout() function

为Promise添加超时控制，如果原Promise未在指定时间内完成则拒绝

此函数使用Promise.race将原始Promise与一个超时Promise竞争， 如果超时Promise先完成，则返回超时错误。

**Signature:**

```typescript
export declare function withTimeout<T>(promise: Promise<T>, ms: number, message?: string): Promise<T>;
```

## Parameters

<table><thead><tr><th>

Parameter


</th><th>

Type


</th><th>

Description


</th></tr></thead>
<tbody><tr><td>

promise


</td><td>

Promise&lt;T&gt;


</td><td>

需要添加超时控制的Promise


</td></tr>
<tr><td>

ms


</td><td>

number


</td><td>

超时毫秒数


</td></tr>
<tr><td>

message


</td><td>

string


</td><td>

_(Optional)_ 超时错误消息


</td></tr>
</tbody></table>
**Returns:**

Promise&lt;T&gt;

带超时控制的Promise，结果与原Promise相同，或在超时时拒绝

## Exceptions

如果原Promise在超时前被拒绝，则传递原始错误；如果超时，则抛出超时错误

## Remarks

版本: 1.0.0 分类: 超时控制

## Example


```typescript
// 为异步函数添加超时控制
try {
  const data = await withTimeout(
    fetch('https://api.example.com/data'),
    5000,
    'API请求超时'
  );
  // 处理数据...
} catch (err) {
  if (err.message === 'API请求超时') {
    // 处理超时情况
  } else {
    // 处理其他错误
  }
}

// 与async/await一起使用
async function fetchWithTimeout(url: string) {
  return withTimeout(
    fetch(url).then(r => r.json()),
    3000,
    '获取数据超时'
  );
}
```

