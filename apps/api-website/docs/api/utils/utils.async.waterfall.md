<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@stratix/utils](./utils.md) &gt; [async](./utils.async.md) &gt; [waterfall](./utils.async.waterfall.md)

## async.waterfall() function

按顺序执行异步函数，每个函数的结果作为下一个函数的输入

此函数接收一个异步函数数组，并按顺序执行它们。第一个函数不接收参数， 后续每个函数都接收前一个函数的返回值作为参数。整个流程的结果是最后一个 函数的返回值。如果任何一个函数抛出异常，整个流程会立即中断并抛出该异常。

**Signature:**

```typescript
export declare function waterfall<T = any>(tasks: Array<(arg?: any) => Promise<any>>): Promise<T>;
```

## Parameters

<table><thead><tr><th>

Parameter


</th><th>

Type


</th><th>

Description


</th></tr></thead>
<tbody><tr><td>

tasks


</td><td>

Array&lt;(arg?: any) =&gt; Promise&lt;any&gt;&gt;


</td><td>

异步函数数组，每个函数接收前一个函数的结果


</td></tr>
</tbody></table>
**Returns:**

Promise&lt;T&gt;

Promise，解析为最后一个任务的结果

## Exceptions

`TypeError` 如果tasks不是数组

`Error` 如果tasks数组为空

`TypeError` 如果任何一项不是函数

如果任何一个任务执行失败，整个流程都会失败

## Remarks

版本: 1.0.0 分类: 流程控制

## Example


```typescript
// 基本使用
const result = await waterfall([
  async () => {
    // 第一个任务不接收参数
    return await fetchUser(1);
  },
  async (user) => {
    // 第二个任务接收第一个任务的结果
    return await fetchUserPosts(user.id);
  },
  async (posts) => {
    // 第三个任务接收第二个任务的结果
    return await processPostData(posts);
  }
]);

// 错误处理
try {
  const result = await waterfall([
    async () => { return 'step 1 result'; },
    async (result) => { throw new Error('步骤2失败'); },
    async (result) => { return 'step 3 result'; }
  ]);
} catch (error) {
  console.error('瀑布流执行失败:', error.message);
  // 整个流程失败，不会执行步骤3
}
```

