# iCalink 智能校园考勤系统环境变量配置示例
# 复制此文件为 .env 并填入实际配置值

# 应用配置
NODE_ENV=development
HOST=0.0.0.0
PORT=3000

# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=icalink
DB_CHARSET=utf8mb4
DB_TIMEZONE=+08:00

# 数据库连接池配置
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_ACQUIRE_TIMEOUT=60000
DB_CREATE_TIMEOUT=30000
DB_DESTROY_TIMEOUT=5000
DB_IDLE_TIMEOUT=30000
DB_REAP_INTERVAL=1000
DB_CREATE_RETRY_INTERVAL=200
DB_PROPAGATE_CREATE_ERROR=false

# 数据库查询配置
DB_QUERY_TIMEOUT=30000
DB_QUERY_RETRIES=3
DB_RETRY_DELAY=1000

# 数据库日志配置
DB_LOGGING_ENABLED=true
DB_LOGGING_LEVEL=info
DB_LOG_QUERIES=true
DB_LOG_QUERY_PARAMS=false
DB_LOG_SLOW_QUERIES=true
DB_SLOW_QUERY_THRESHOLD=1000

# 数据库迁移配置
DB_MIGRATIONS_ENABLED=true
DB_MIGRATIONS_DIR=./database/migrations
DB_MIGRATIONS_TABLE=knex_migrations
DB_MIGRATIONS_EXT=sql

# 数据库种子数据配置
DB_SEEDS_ENABLED=false
DB_SEEDS_DIR=./database/seeds

# SSL配置
DB_SSL_ENABLED=false
DB_SSL_REJECT_UNAUTHORIZED=true
DB_SSL_CA=
DB_SSL_CERT=
DB_SSL_KEY=

# 调试配置
DB_DEBUG=false

# 事务配置
DB_TRANSACTION_TIMEOUT=30000
DB_ISOLATION_LEVEL=READ_COMMITTED

# 健康检查配置
DB_HEALTH_CHECK_ENABLED=true
DB_HEALTH_CHECK_INTERVAL=30000
DB_HEALTH_CHECK_TIMEOUT=5000
DB_HEALTH_CHECK_RETRIES=3

# 日志配置
LOG_LEVEL=info
LOG_PRETTY_PRINT=true
LOG_FILE_ENABLED=false
LOG_FILE_PATH=./logs
LOG_FILE_MAX_SIZE=10MB
LOG_FILE_MAX_FILES=5
LOG_FILE_DATE_PATTERN=YYYY-MM-DD
LOG_REQUESTS=true
LOG_RESPONSES=false

# 安全配置
CORS_ORIGIN=*
CORS_CREDENTIALS=true
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=1 minute
RATE_LIMIT_SKIP_SUCCESS=false
RATE_LIMIT_SKIP_FAILED=false

# API密钥配置
API_KEY_ENABLED=false
API_KEY_HEADER=X-API-Key
API_KEYS=

# 缓存配置
REDIS_ENABLED=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=icalink:
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000
REDIS_RETRY_DELAY=100
REDIS_MAX_RETRIES=3

# 内存缓存配置
MEMORY_CACHE_ENABLED=true
MEMORY_CACHE_MAX_SIZE=100
MEMORY_CACHE_TTL=300
MEMORY_CACHE_CHECK_PERIOD=60

# 缓存策略配置
CACHE_USER_INFO_TTL=300
CACHE_COURSE_INFO_TTL=600
CACHE_ATTENDANCE_STATS_TTL=180
CACHE_SYSTEM_CONFIG_TTL=1800

# 文件上传配置
UPLOAD_MAX_FILE_SIZE=10485760
UPLOAD_MAX_FILES=5
UPLOAD_STORAGE_TYPE=local
UPLOAD_LOCAL_DIR=./uploads
UPLOAD_PUBLIC_PATH=/uploads

# 图片处理配置
IMAGE_PROCESSING_ENABLED=false
THUMBNAIL_WIDTH=200
THUMBNAIL_HEIGHT=200
THUMBNAIL_QUALITY=80
IMAGE_COMPRESSION_ENABLED=false
IMAGE_COMPRESSION_QUALITY=85

# 监控配置
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/health
HEALTH_CHECK_INTERVAL=30000
METRICS_ENABLED=false
METRICS_ENDPOINT=/metrics
COLLECT_DEFAULT_METRICS=true
METRICS_COLLECT_INTERVAL=10000

# 业务配置
ATTENDANCE_CHECKIN_WINDOW=30
ATTENDANCE_LATE_THRESHOLD=10
ATTENDANCE_AUTO_ABSENT_AFTER=60
ATTENDANCE_LOCATION_RADIUS=100
ATTENDANCE_ENABLE_LOCATION=false

# 请假配置
LEAVE_AUTO_APPROVAL_TIMEOUT=24
LEAVE_MAX_APPLICATIONS_PER_DAY=3
LEAVE_ENABLE_AUTO_NOTIFICATION=true
